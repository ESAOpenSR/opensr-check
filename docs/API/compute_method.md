#

## The `compute` Method

The `compute` method calculate the suite of metrics in the `opensr-test` framework. This method includes three mandatory parameters, and one optional parameter:

- **lr** (*torch.Tensor*): The Low Resolution (LR) image tensor. The shape of the tensor should be `(channel, height/n, width/n)`. Where `n` is the scaling factor of the Super-Resolution (SR) image.

- **sr** (*torch.Tensor*): The Super-Resolved (SR) image tensor generated by the model under evaluation. The shape of the tensor should be `(channel, height, width)`.

- **hr** (*torch.Tensor*): The High Resolution (HR) image tensor (ground truth). The shape of the tensor should be `(channel, height, width)`.

- **gradient_threshold** (default=0.01): Ignore the pixels with gradients below this threshold. This parameter is used to filter out pixels with insignificant differences between the SR and HR images. The default value is set to 0.01, which is optimized for balanced assessment. However, this parameter can be adjusted to each image. Based on the expert judgment of three remote sensing specialists, the optimal value of this parameter has been determined for each image within the opensr-test datasets, allowing for a more tailored and precise evaluation for each specific dataset.


Below is an example that demonstrates the usage of the `compute` method with the aforementioned parameters:

```python
# Import necessary libraries
import torch
import opensr_test
import matplotlib.pyplot as plt

# Generate sample LR, HR, and SR images
lr = torch.rand(4, 32, 32)  # Low Resolution image
hr = torch.rand(4, 256, 256)  # High Resolution image
sr = torch.rand(4, 256, 256)  # Super Resolution image

# Initialize the Metrics object
metrics = opensr_test.Metrics()

# Compute the metrics with specified parameters
metrics.compute( 
    lr=lr, sr=sr, hr=hr,
    stability_threshold=0.03
)
```
